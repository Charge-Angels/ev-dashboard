<div class="charger-param-component">
  <form class="form" [formGroup]="formGroup">
    <div class="right-actions d-flex flex-row mat-toolbar-row mb-2">
      <button mat-raised-button color="primary" (click)="saveAndApplyChargingProfile()"
          [disabled]="!scheduleEditableTableDataSource || scheduleEditableTableDataSource.getContent().length === 0 || !formGroup.dirty || !formGroup.valid || chargingProfiles.length > 1">
        <mat-icon>save</mat-icon><span>{{'general.apply' | translate}}</span>
      </button>
      <button mat-raised-button color="primary" (click)="deleteChargingProfile()" [disabled]="chargingProfiles.length === 0 || chargingProfiles.length > 1">
        <mat-icon>delete</mat-icon><span>{{'general.delete' | translate}}</span>
      </button>
      <button mat-raised-button color="primary" (click)="refresh()">
        <mat-icon>refresh</mat-icon><span>{{'general.refresh' | translate}}</span>
      </button>
    </div>
    <div class="row">
      <div class="form-group col-md-4">
        <div class="row">
          <div *ngIf="chargingProfiles.length > 1" class="form-group col-md-12 mb-1 m-1">
            <mat-form-field>
              <mat-select [disabled]="!chargingProfiles"
                  [formControl]="chargingProfilesControl" placeholder="{{'chargers.smart_charging.charging_profile_limit' | translate}}">
                <mat-option *ngFor="let chargingProfile of chargingProfiles" [value]="chargingProfile">
                  {{'chargers.connector' | translate}} {{chargingProfile.connectorID}} ({{'chargers.smart_charging.stack_level' | translate}} {{chargingProfile.profile.stackLevel}})
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="form-group col-md-12 mb-1">
            <mat-form-field>
              <mat-select [formControl]="profileTypeControl"
                placeholder="{{'chargers.smart_charging.profile_type' | translate}}" required>
                <mat-option *ngFor="let profileType of profileTypeMap" [value]="profileType">
                  {{profileType.description | translate}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="form-group col-md-12 mb-1">
            <mat-form-field>
              <mat-datetimepicker #pickerDateStart type="datetime" openOnFocus="false" mode="portrait" timeInterval="1">
              </mat-datetimepicker>
              <mat-datetimepicker-toggle matSuffix [for]="pickerDateStart" matSuffix></mat-datetimepicker-toggle>
              <input matInput placeholder="{{'chargers.smart_charging.start_date' | translate}}" required
                (dateChange)="startDateFilterChanged($event.value ? $event.value.toDate() : null)" [matDatetimepicker]="pickerDateStart"
                [formControl]="startDateControl" autocomplete="false">
              <mat-error *ngIf="startDateControl.errors?.matDatepickerParse">{{"general.invalid_date" | translate}}</mat-error>
              <mat-error *ngIf="startDateControl.errors?.dateNotInFuture">{{"chargers.smart_charging.date_not_in_past" | translate}}</mat-error>
            </mat-form-field>
          </div>
          <div class="form-group col-md-12 mb-1 text-left">
            <mat-error *ngIf="endDateControl.errors?.endDateOutOfRecurringLimit">{{"chargers.smart_charging.date_out_of_limit" | translate}}</mat-error>
          </div>
        </div>
      </div>
      <div class="text-right col-md-8 chart-position-in-pop-up">
        <app-charging-station-smart-charging-limit-planner-chart #limitChart>
        </app-charging-station-smart-charging-limit-planner-chart>
      </div>
    </div>
    <div *ngIf="this.chargingProfiles.length > 1">
      <app-table [dataSource]="scheduleTableDataSource"></app-table>
    </div>
      <div *ngIf="this.chargingProfiles.length <= 1" class="limit-planner-table-postion">
        <app-table [dataSource]="scheduleEditableTableDataSource"></app-table>
    </div>
  </form>
</div>
